<?PHP

/***************************************************************************************
 *                               adr_functions_exploits.php
 *                              ----------------------------
 *		Version			: 1.0.0
 *		Authors			: aUsTiN 		
 *							[ (austin_inc@hotmail.com) 		(http://phpbb-amod.com) 	]
 *						  Seteo-Bloke 	
 *							[ (admin@thegamingforum.com) 	(http://www.thegamingforum.com/adr/index.php) 	]
 *
 ***************************************************************************************/

	function unexploit_user_characteristics($user)
	{
		global $db;
	
		$q = "SELECT * FROM ". ADR_EXPLOIT_FIX ."
			  WHERE user_id = '". $user ."'";
		$r = $db -> sql_query($q);
		$char_data = $db -> sql_fetchrow($r);
	
		$details = $char_data['power'] .'%SPLIT%';
		$details .= $char_data['agility'] .'%SPLIT%';
		$details .= $char_data['endurance'] .'%SPLIT%';
		$details .= $char_data['intelligence'] .'%SPLIT%';
		$details .= $char_data['willpower'] .'%SPLIT%';		
		$details .= $char_data['charm'] .'%SPLIT%';
		$details .= $char_data['magic_attack'] .'%SPLIT%';								
		$details .= $char_data['magic_resistance'] .'%SPLIT%';
												
		return $details;
	}
	
	function set_unexploited_characteristics($user, $min, $max, $allow_reroll)	
	{
		global $db;
	
		$power 			= rand($min, $max);
		$agility 			= rand($min, $max);
		$endurance 			= rand($min, $max);
		$intelligence 		= rand($min, $max);
		$willpower 			= rand($min, $max);
		$charm 			= rand($min, $max);
		$magic_attack 		= rand($min, $max);
		$magic_resistance 	= rand($min, $max);
	
		$q = "SELECT * FROM ". ADR_EXPLOIT_FIX ."
			  WHERE user_id = '". $user ."'";
		$r = $db -> sql_query($q);
		$char_data 	= $db -> sql_fetchrow($r);
		
		if (!$char_data['user_id'])
		{
			$q = "INSERT INTO ". ADR_EXPLOIT_FIX ."
			  (user_id, power, agility, endurance, intelligence, willpower, charm, magic_attack, magic_resistance)
			  VALUES ('". $user ."', '". $power ."', '". $agility ."', '". $endurance ."', '". $intelligence ."', '". $willpower ."', '". $charm ."', '". $magic_attack ."', '". $magic_resistance ."')";
			$r = $db -> sql_query($q);
		}
		
		if ($allow_reroll)
		{
			$q = "UPDATE ". ADR_EXPLOIT_FIX ."
			  SET power = '". $power ."', agility = '". $agility ."', endurance = '". $endurance ."', intelligence = '". $intelligence ."',
			  willpower = '". $willpower ."', charm = '". $charm ."', magic_attack = '". $magic_attack ."', magic_resistance = '". $magic_resistance ."'
			  WHERE user_id = '". $user ."'";
			$r = $db -> sql_query($q);
		}
	}
		
	function delete_unexploited_characteristics($user)	
	{
		global $db;
	
		$q = "DELETE FROM ". ADR_EXPLOIT_FIX ."
			  WHERE user_id = '". $user ."'";
		$r = $db -> sql_query($q);
			
	}		
?>